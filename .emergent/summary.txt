<analysis>
The user wants to build a comprehensive field data collection and device tracking application. The project uses an Expo (React Native) frontend, a FastAPI backend, and a MongoDB database.

The trajectory shows a highly iterative development process driven by user feedback. Initial work focused on setting up the core architecture: a secure API with JWT authentication, basic data models, and a mobile app with tab-based navigation. A key early challenge was map rendering, which was solved by embedding Leaflet.js in a .

Recent development has been rapid, addressing a series of feature requests and bug fixes. Major features implemented include:
1.  **Multi-Survey Integration:** A  was created to manage a globally selected survey, and screens like the Dashboard and Map were updated to filter data accordingly.
2.  **Web Dashboard:** A static web dashboard was created and served via the FastAPI backend. It initially failed due to authentication issues, which were resolved by creating dedicated public, read-only API endpoints. A bulk user upload/assignment feature was then added.
3.  **Mobile UI/UX Overhaul:** The mobile app's home screen was completely redesigned. The main Dashboard tab was removed, and the Surveys list became the new home screen. This screen was enhanced with a user greeting, survey-specific statistics, and a pinned/active view with a button to navigate to a separate All Surveys search screen. A professional splash screen animation was also added.
4.  **Bug Fixes:** Numerous bugs were addressed, including data persistence for respondent status updates, a 500 error in the chat API due to serialization issues, and several Expo Go connection problems.

The user's language has shifted to Indonesian. The next agent must respond in **Bahasa Indonesia**.
</analysis>

<product_requirements>
The goal is to build a multi-user, real-time device tracking application for monitoring field data collection activities.

**Core Functionality:**
*   **Mobile App (Expo/React Native):** For Enumerators and Supervisors to conduct surveys, track progress, and communicate.
*   **Web Dashboard:** For Admins and Leaders to monitor overall progress, user locations, and manage survey assignments.
*   **Role-Based Access:** Differentiated features for Admin, Supervisor, and Enumerator roles.

**Key Features Implemented:**
*   **Real-time Tracking:** Enumerator locations are tracked and displayed on a Leaflet.js map.
*   **Map Visualization:** Color-coded markers represent respondent status (Pending, In-progress, Completed).
*   **Multi-Survey Support:** The app now filters data on the map and dashboard based on a globally selected survey.
*   **Redesigned Home Screen:** The app opens to a survey list showing pinned active surveys, with a button to view all surveys on a separate searchable screen. Cards now show preview stats.
*   **Web Dashboard:** A functional dashboard provides real-time statistics and a map view. It includes a feature for admins to bulk upload and assign enumerators/supervisors to surveys via an XLSX file.
*   **In-App Status Updates:** Enumerators can update a respondent's status directly from the map's list view via an aesthetic, custom modal.
*   **Introductory Animation:** A professional splash screen animation appears before the login screen.
</product_requirements>

<key_technical_concepts>
- **Full-Stack Architecture:** Expo (React Native), FastAPI (Python), MongoDB.
- **Authentication:** JWT (JSON Web Tokens).
- **Mapping:**  embedding Leaflet.js with OpenStreetMap.
- **State Management:** React Context API (, ).
- **API Communication:**  client for RESTful API calls.
- **UI & Animation:**  for the splash screen.
- **Keyboard Handling:**  for chat input.
</key_technical_concepts>

<code_architecture>
The project is a monorepo with , , and  directories.



-   ****
    -   **Importance:** The core API. Defines all endpoints, data models, and business logic.
    -   **Changes:** Heavily modified to add public, read-only endpoints for the web dashboard (e.g., ), new endpoints for bulk user assignment (), and bug fixes for data persistence and ObjectId serialization in the chat API.

-   ****
    -   **Importance:** The application's entry point.
    -   **Changes:** Refactored to manage the initial view. It now displays a splash screen animation for 3.5 seconds and then navigates the user either to the login screen or directly to the main app layout (), correctly bypassing the now-defunct dashboard.

-   ****
    -   **Importance:** Defines the main tab navigation structure.
    -   **Changes:** Modified to completely remove the  tab, making  the default home screen. It also hides the  and  screens from the tab bar, making them accessible only through navigation actions.

-   ****
    -   **Importance:** The new Home screen for authenticated users.
    -   **Changes:** Completely redesigned to display a personalized greeting, a list of active or pinned surveys with progress statistics on each card, and a Lihat Semua Survey button that navigates to the  screen.

-   ****
    -   **Importance:** A new screen created to display a comprehensive, searchable list of all surveys a user is assigned to.
    -   **Changes:** Created from scratch with a search bar and a  to render all surveys fetched from the API.

-   ****
    -   **Importance:** Visualizes respondent and enumerator locations.
    -   **Changes:** Enhanced with a feature for users to update a respondent's status (, , ) via a custom, aesthetic modal. A bug was fixed to ensure status changes are persisted to the database and the local state is updated correctly upon success.

-   ****
    -   **Importance:** The in-app messaging feature.
    -   **Changes:** A backend bug causing a 500 error on message send was fixed. The file is currently being modified to resolve a UI bug where the keyboard covers the text input field when a user is typing.
</code_architecture>

<pending_tasks>
- **Finalize Chat Keyboard Fix:** The current work on the  screen to prevent the keyboard from obscuring the text input needs to be completed and verified.
- **Implement Survey Detail Screen:** The  file exists but is a placeholder. It needs to be implemented to show detailed statistics and progress for a single selected survey, fulfilling the original intent of replacing the old Dashboard screen.
- **Test Bulk Upload End-to-End:** The web dashboard's bulk user upload feature has been built but requires thorough end-to-end testing.
</pending_tasks>

<current_work>
The AI engineer was in the middle of fixing a critical UI bug in the chat screen (). The user reported and provided a screenshot showing that when they tried to type a message, the on-screen keyboard would cover the text input field, making it impossible to see what they were typing.

The previous fix attempt involving minor adjustments to  was insufficient. The current, in-progress approach involves a more significant refactoring of the  component's JSX structure. The goal is to properly isolate the message list and the input bar, wrapping them in a  with the correct  and  props to ensure the input bar reliably moves up and stays visible above the keyboard on both iOS and Android devices. The last actions taken were editing the  file to restructure the layout.
</current_work>

<optional_next_step>
Continue fixing the keyboard issue in  by correctly structuring the  to wrap the message list and input bar, ensuring the input stays visible when the keyboard is active.
</optional_next_step>
