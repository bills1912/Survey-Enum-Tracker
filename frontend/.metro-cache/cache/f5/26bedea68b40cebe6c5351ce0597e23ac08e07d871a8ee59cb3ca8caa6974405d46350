{"dependencies":[{"name":"@babel/runtime/helpers/asyncToGenerator","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"YisBBiy2Xm9DEVdFebZ2nbgAHBo=","exportNames":["*"],"imports":1}},{"name":"@react-native-community/netinfo","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"PqZcYTlMIVnzFjdViPzMiGUu7Hg=","exportNames":["*"],"imports":1}},{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":43,"index":98}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":63,"index":162}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"syncService\", {\n    enumerable: true,\n    get: function () {\n      return syncService;\n    }\n  });\n  var _babelRuntimeHelpersAsyncToGenerator = require(_dependencyMap[0], \"@babel/runtime/helpers/asyncToGenerator\");\n  var _asyncToGenerator = _interopDefault(_babelRuntimeHelpersAsyncToGenerator);\n  var _reactNativeCommunityNetinfo = require(_dependencyMap[1], \"@react-native-community/netinfo\");\n  var NetInfo = _interopDefault(_reactNativeCommunityNetinfo);\n  var _storage = require(_dependencyMap[2], \"./storage\");\n  var _api = require(_dependencyMap[3], \"./api\");\n  var syncService = {\n    syncAll() {\n      var _this = this;\n      return (0, _asyncToGenerator.default)(function* () {\n        var netInfo = yield NetInfo.default.fetch();\n        if (!netInfo.isConnected) {\n          console.log('No internet connection, skipping sync');\n          return {\n            success: false,\n            message: 'No internet connection'\n          };\n        }\n        try {\n          // Sync locations\n          yield _this.syncLocations();\n\n          // Sync messages\n          yield _this.syncMessages();\n\n          // Sync respondents\n          yield _this.syncRespondents();\n          return {\n            success: true,\n            message: 'All data synced successfully'\n          };\n        } catch (error) {\n          console.error('Sync error:', error);\n          return {\n            success: false,\n            message: 'Sync failed',\n            error\n          };\n        }\n      })();\n    },\n    syncLocations() {\n      return (0, _asyncToGenerator.default)(function* () {\n        var pendingLocations = yield _storage.storageService.getPendingLocations();\n        if (pendingLocations.length === 0) return;\n        console.log(`Syncing ${pendingLocations.length} locations`);\n        yield _api.locationAPI.createLocationsBatch(pendingLocations);\n        yield _storage.storageService.clearPendingLocations();\n      })();\n    },\n    syncMessages() {\n      return (0, _asyncToGenerator.default)(function* () {\n        var pendingMessages = yield _storage.storageService.getPendingMessages();\n        if (pendingMessages.length === 0) return;\n        console.log(`Syncing ${pendingMessages.length} messages`);\n        yield _api.messageAPI.createMessagesBatch(pendingMessages);\n        yield _storage.storageService.clearPendingMessages();\n      })();\n    },\n    syncRespondents() {\n      return (0, _asyncToGenerator.default)(function* () {\n        var pendingRespondents = yield _storage.storageService.getPendingRespondents();\n        if (pendingRespondents.length === 0) return;\n        console.log(`Syncing ${pendingRespondents.length} respondents`);\n        for (var respondent of pendingRespondents) {\n          if (respondent.id) {\n            yield _api.respondentAPI.updateRespondent(respondent.id, respondent);\n          }\n        }\n        yield _storage.storageService.clearPendingRespondents();\n      })();\n    },\n    startAutoSync() {\n      var intervalMinutes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 2;\n      return setInterval(() => {\n        this.syncAll();\n      }, intervalMinutes * 60 * 1000);\n    }\n  };\n});","lineCount":97,"map":[[12,2,5,0,"Object"],[12,8,5,0],[12,9,5,0,"defineProperty"],[12,23,5,0],[12,24,5,0,"exports"],[12,31,5,0],[13,4,5,0,"enumerable"],[13,14,5,0],[14,4,5,0,"get"],[14,7,5,0],[14,18,5,0,"get"],[14,19,5,0],[15,6,5,0],[15,13,5,0,"syncService"],[15,24,5,0],[16,4,5,0],[17,2,5,0],[18,2,76,2],[18,6,76,2,"_babelRuntimeHelpersAsyncToGenerator"],[18,42,76,2],[18,45,76,2,"require"],[18,52,76,2],[18,53,76,2,"_dependencyMap"],[18,67,76,2],[19,2,76,2],[19,6,76,2,"_asyncToGenerator"],[19,23,76,2],[19,26,76,2,"_interopDefault"],[19,41,76,2],[19,42,76,2,"_babelRuntimeHelpersAsyncToGenerator"],[19,78,76,2],[20,2,1,0],[20,6,1,0,"_reactNativeCommunityNetinfo"],[20,34,1,0],[20,37,1,0,"require"],[20,44,1,0],[20,45,1,0,"_dependencyMap"],[20,59,1,0],[21,2,1,0],[21,6,1,0,"NetInfo"],[21,13,1,0],[21,16,1,0,"_interopDefault"],[21,31,1,0],[21,32,1,0,"_reactNativeCommunityNetinfo"],[21,60,1,0],[22,2,2,0],[22,6,2,0,"_storage"],[22,14,2,0],[22,17,2,0,"require"],[22,24,2,0],[22,25,2,0,"_dependencyMap"],[22,39,2,0],[23,2,3,0],[23,6,3,0,"_api"],[23,10,3,0],[23,13,3,0,"require"],[23,20,3,0],[23,21,3,0,"_dependencyMap"],[23,35,3,0],[24,2,5,7],[24,6,5,13,"syncService"],[24,17,5,24],[24,20,5,27],[25,4,6,8,"syncAll"],[25,11,6,15,"syncAll"],[25,12,6,15],[25,14,6,18],[26,6,6,18],[26,10,6,18,"_this"],[26,15,6,18],[27,6,6,18],[27,17,6,18,"_asyncToGenerator"],[27,34,6,18],[27,35,6,18,"default"],[27,42,6,18],[28,8,7,4],[28,12,7,10,"netInfo"],[28,19,7,17],[28,28,7,26,"NetInfo"],[28,35,7,33],[28,36,7,33,"default"],[28,43,7,33],[28,44,7,34,"fetch"],[28,49,7,39],[28,50,7,40],[28,51,7,41],[29,8,8,4],[29,12,8,8],[29,13,8,9,"netInfo"],[29,20,8,16],[29,21,8,17,"isConnected"],[29,32,8,28],[29,34,8,30],[30,10,9,6,"console"],[30,17,9,13],[30,18,9,14,"log"],[30,21,9,17],[30,22,9,18],[30,61,9,57],[30,62,9,58],[31,10,10,6],[31,17,10,13],[32,12,11,8,"success"],[32,19,11,15],[32,21,11,17],[32,26,11,22],[33,12,12,8,"message"],[33,19,12,15],[33,21,12,17],[34,10,13,6],[34,11,13,7],[35,8,14,4],[36,8,16,4],[36,12,16,8],[37,10,17,6],[38,10,18,6],[38,16,18,12,"_this"],[38,21,18,16],[38,22,18,17,"syncLocations"],[38,35,18,30],[38,36,18,31],[38,37,18,32],[40,10,20,6],[41,10,21,6],[41,16,21,12,"_this"],[41,21,21,16],[41,22,21,17,"syncMessages"],[41,34,21,29],[41,35,21,30],[41,36,21,31],[43,10,23,6],[44,10,24,6],[44,16,24,12,"_this"],[44,21,24,16],[44,22,24,17,"syncRespondents"],[44,37,24,32],[44,38,24,33],[44,39,24,34],[45,10,26,6],[45,17,26,13],[46,12,27,8,"success"],[46,19,27,15],[46,21,27,17],[46,25,27,21],[47,12,28,8,"message"],[47,19,28,15],[47,21,28,17],[48,10,29,6],[48,11,29,7],[49,8,30,4],[49,9,30,5],[49,10,30,6],[49,17,30,13,"error"],[49,22,30,18],[49,24,30,20],[50,10,31,6,"console"],[50,17,31,13],[50,18,31,14,"error"],[50,23,31,19],[50,24,31,20],[50,37,31,33],[50,39,31,35,"error"],[50,44,31,40],[50,45,31,41],[51,10,32,6],[51,17,32,13],[52,12,33,8,"success"],[52,19,33,15],[52,21,33,17],[52,26,33,22],[53,12,34,8,"message"],[53,19,34,15],[53,21,34,17],[53,34,34,30],[54,12,35,8,"error"],[55,10,36,6],[55,11,36,7],[56,8,37,4],[57,6,37,5],[58,4,38,2],[58,5,38,3],[59,4,40,8,"syncLocations"],[59,17,40,21,"syncLocations"],[59,18,40,21],[59,20,40,24],[60,6,40,24],[60,17,40,24,"_asyncToGenerator"],[60,34,40,24],[60,35,40,24,"default"],[60,42,40,24],[61,8,41,4],[61,12,41,10,"pendingLocations"],[61,28,41,26],[61,37,41,35,"storageService"],[61,45,41,49],[61,46,41,49,"storageService"],[61,60,41,49],[61,61,41,50,"getPendingLocations"],[61,80,41,69],[61,81,41,70],[61,82,41,71],[62,8,42,4],[62,12,42,8,"pendingLocations"],[62,28,42,24],[62,29,42,25,"length"],[62,35,42,31],[62,40,42,36],[62,41,42,37],[62,43,42,39],[63,8,44,4,"console"],[63,15,44,11],[63,16,44,12,"log"],[63,19,44,15],[63,20,44,16],[63,31,44,27,"pendingLocations"],[63,47,44,43],[63,48,44,44,"length"],[63,54,44,50],[63,66,44,62],[63,67,44,63],[64,8,45,4],[64,14,45,10,"locationAPI"],[64,18,45,21],[64,19,45,21,"locationAPI"],[64,30,45,21],[64,31,45,22,"createLocationsBatch"],[64,51,45,42],[64,52,45,43,"pendingLocations"],[64,68,45,59],[64,69,45,60],[65,8,46,4],[65,14,46,10,"storageService"],[65,22,46,24],[65,23,46,24,"storageService"],[65,37,46,24],[65,38,46,25,"clearPendingLocations"],[65,59,46,46],[65,60,46,47],[65,61,46,48],[66,6,46,49],[67,4,47,2],[67,5,47,3],[68,4,49,8,"syncMessages"],[68,16,49,20,"syncMessages"],[68,17,49,20],[68,19,49,23],[69,6,49,23],[69,17,49,23,"_asyncToGenerator"],[69,34,49,23],[69,35,49,23,"default"],[69,42,49,23],[70,8,50,4],[70,12,50,10,"pendingMessages"],[70,27,50,25],[70,36,50,34,"storageService"],[70,44,50,48],[70,45,50,48,"storageService"],[70,59,50,48],[70,60,50,49,"getPendingMessages"],[70,78,50,67],[70,79,50,68],[70,80,50,69],[71,8,51,4],[71,12,51,8,"pendingMessages"],[71,27,51,23],[71,28,51,24,"length"],[71,34,51,30],[71,39,51,35],[71,40,51,36],[71,42,51,38],[72,8,53,4,"console"],[72,15,53,11],[72,16,53,12,"log"],[72,19,53,15],[72,20,53,16],[72,31,53,27,"pendingMessages"],[72,46,53,42],[72,47,53,43,"length"],[72,53,53,49],[72,64,53,60],[72,65,53,61],[73,8,54,4],[73,14,54,10,"messageAPI"],[73,18,54,20],[73,19,54,20,"messageAPI"],[73,29,54,20],[73,30,54,21,"createMessagesBatch"],[73,49,54,40],[73,50,54,41,"pendingMessages"],[73,65,54,56],[73,66,54,57],[74,8,55,4],[74,14,55,10,"storageService"],[74,22,55,24],[74,23,55,24,"storageService"],[74,37,55,24],[74,38,55,25,"clearPendingMessages"],[74,58,55,45],[74,59,55,46],[74,60,55,47],[75,6,55,48],[76,4,56,2],[76,5,56,3],[77,4,58,8,"syncRespondents"],[77,19,58,23,"syncRespondents"],[77,20,58,23],[77,22,58,26],[78,6,58,26],[78,17,58,26,"_asyncToGenerator"],[78,34,58,26],[78,35,58,26,"default"],[78,42,58,26],[79,8,59,4],[79,12,59,10,"pendingRespondents"],[79,30,59,28],[79,39,59,37,"storageService"],[79,47,59,51],[79,48,59,51,"storageService"],[79,62,59,51],[79,63,59,52,"getPendingRespondents"],[79,84,59,73],[79,85,59,74],[79,86,59,75],[80,8,60,4],[80,12,60,8,"pendingRespondents"],[80,30,60,26],[80,31,60,27,"length"],[80,37,60,33],[80,42,60,38],[80,43,60,39],[80,45,60,41],[81,8,62,4,"console"],[81,15,62,11],[81,16,62,12,"log"],[81,19,62,15],[81,20,62,16],[81,31,62,27,"pendingRespondents"],[81,49,62,45],[81,50,62,46,"length"],[81,56,62,52],[81,70,62,66],[81,71,62,67],[82,8,63,4],[82,13,63,9],[82,17,63,15,"respondent"],[82,27,63,25],[82,31,63,29,"pendingRespondents"],[82,49,63,47],[82,51,63,49],[83,10,64,6],[83,14,64,10,"respondent"],[83,24,64,20],[83,25,64,21,"id"],[83,27,64,23],[83,29,64,25],[84,12,65,8],[84,18,65,14,"respondentAPI"],[84,22,65,27],[84,23,65,27,"respondentAPI"],[84,36,65,27],[84,37,65,28,"updateRespondent"],[84,53,65,44],[84,54,65,45,"respondent"],[84,64,65,55],[84,65,65,56,"id"],[84,67,65,58],[84,69,65,60,"respondent"],[84,79,65,70],[84,80,65,71],[85,10,66,6],[86,8,67,4],[87,8,68,4],[87,14,68,10,"storageService"],[87,22,68,24],[87,23,68,24,"storageService"],[87,37,68,24],[87,38,68,25,"clearPendingRespondents"],[87,61,68,48],[87,62,68,49],[87,63,68,50],[88,6,68,51],[89,4,69,2],[89,5,69,3],[90,4,71,2,"startAutoSync"],[90,17,71,15,"startAutoSync"],[90,18,71,15],[90,20,71,45],[91,6,71,45],[91,10,71,16,"intervalMinutes"],[91,25,71,39],[91,28,71,39,"arguments"],[91,37,71,39],[91,38,71,39,"length"],[91,44,71,39],[91,52,71,39,"arguments"],[91,61,71,39],[91,69,71,39,"undefined"],[91,78,71,39],[91,81,71,39,"arguments"],[91,90,71,39],[91,96,71,42],[91,97,71,43],[92,6,72,4],[92,13,72,11,"setInterval"],[92,24,72,22],[92,25,72,23],[92,31,72,29],[93,8,73,6],[93,12,73,10],[93,13,73,11,"syncAll"],[93,20,73,18],[93,21,73,19],[93,22,73,20],[94,6,74,4],[94,7,74,5],[94,9,74,7,"intervalMinutes"],[94,24,74,22],[94,27,74,25],[94,29,74,27],[94,32,74,30],[94,36,74,34],[94,37,74,35],[95,4,75,2],[96,2,76,0],[96,3,76,1],[97,0,76,2],[97,3]],"functionMap":{"names":["<global>","syncAll","syncLocations","syncMessages","syncRespondents","startAutoSync","setInterval$argument_0"],"mappings":"AAA;ECK;GDgC;EEE;GFO;EGE;GHO;EIE;GJW;EKE;uBCC;KDE;GLC"},"hasCjsExports":false},"type":"js/module"}]}