{"dependencies":[{"name":"@react-native-community/netinfo","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":1,"column":0,"index":0},"end":{"line":1,"column":54,"index":54}}],"key":"PqZcYTlMIVnzFjdViPzMiGUu7Hg=","exportNames":["*"],"imports":1}},{"name":"./storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":55},"end":{"line":2,"column":43,"index":98}}],"key":"3rLtLV8J3gSw9c8Ep8Wpc3w/Yxg=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":99},"end":{"line":3,"column":63,"index":162}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  Object.defineProperty(exports, \"syncService\", {\n    enumerable: true,\n    get: function () {\n      return syncService;\n    }\n  });\n  var _reactNativeCommunityNetinfo = require(_dependencyMap[0], \"@react-native-community/netinfo\");\n  var NetInfo = _interopDefault(_reactNativeCommunityNetinfo);\n  var _storage = require(_dependencyMap[1], \"./storage\");\n  var _api = require(_dependencyMap[2], \"./api\");\n  const syncService = {\n    async syncAll() {\n      const netInfo = await NetInfo.default.fetch();\n      if (!netInfo.isConnected) {\n        console.log('No internet connection, skipping sync');\n        return {\n          success: false,\n          message: 'No internet connection'\n        };\n      }\n      try {\n        // Sync locations\n        await this.syncLocations();\n\n        // Sync messages\n        await this.syncMessages();\n\n        // Sync respondents\n        await this.syncRespondents();\n        return {\n          success: true,\n          message: 'All data synced successfully'\n        };\n      } catch (error) {\n        console.error('Sync error:', error);\n        return {\n          success: false,\n          message: 'Sync failed',\n          error\n        };\n      }\n    },\n    async syncLocations() {\n      const pendingLocations = await _storage.storageService.getPendingLocations();\n      if (pendingLocations.length === 0) return;\n      console.log(`Syncing ${pendingLocations.length} locations`);\n      await _api.locationAPI.createLocationsBatch(pendingLocations);\n      await _storage.storageService.clearPendingLocations();\n    },\n    async syncMessages() {\n      const pendingMessages = await _storage.storageService.getPendingMessages();\n      if (pendingMessages.length === 0) return;\n      console.log(`Syncing ${pendingMessages.length} messages`);\n      await _api.messageAPI.createMessagesBatch(pendingMessages);\n      await _storage.storageService.clearPendingMessages();\n    },\n    async syncRespondents() {\n      const pendingRespondents = await _storage.storageService.getPendingRespondents();\n      if (pendingRespondents.length === 0) return;\n      console.log(`Syncing ${pendingRespondents.length} respondents`);\n      for (const respondent of pendingRespondents) {\n        if (respondent.id) {\n          await _api.respondentAPI.updateRespondent(respondent.id, respondent);\n        }\n      }\n      await _storage.storageService.clearPendingRespondents();\n    },\n    startAutoSync(intervalMinutes = 2) {\n      return setInterval(() => {\n        this.syncAll();\n      }, intervalMinutes * 60 * 1000);\n    }\n  };\n});","lineCount":85,"map":[[12,2,5,0,"Object"],[12,8,5,0],[12,9,5,0,"defineProperty"],[12,23,5,0],[12,24,5,0,"exports"],[12,31,5,0],[13,4,5,0,"enumerable"],[13,14,5,0],[14,4,5,0,"get"],[14,7,5,0],[14,18,5,0,"get"],[14,19,5,0],[15,6,5,0],[15,13,5,0,"syncService"],[15,24,5,0],[16,4,5,0],[17,2,5,0],[18,2,1,0],[18,6,1,0,"_reactNativeCommunityNetinfo"],[18,34,1,0],[18,37,1,0,"require"],[18,44,1,0],[18,45,1,0,"_dependencyMap"],[18,59,1,0],[19,2,1,0],[19,6,1,0,"NetInfo"],[19,13,1,0],[19,16,1,0,"_interopDefault"],[19,31,1,0],[19,32,1,0,"_reactNativeCommunityNetinfo"],[19,60,1,0],[20,2,2,0],[20,6,2,0,"_storage"],[20,14,2,0],[20,17,2,0,"require"],[20,24,2,0],[20,25,2,0,"_dependencyMap"],[20,39,2,0],[21,2,3,0],[21,6,3,0,"_api"],[21,10,3,0],[21,13,3,0,"require"],[21,20,3,0],[21,21,3,0,"_dependencyMap"],[21,35,3,0],[22,2,5,7],[22,8,5,13,"syncService"],[22,19,5,24],[22,22,5,27],[23,4,6,2],[23,10,6,8,"syncAll"],[23,17,6,15,"syncAll"],[23,18,6,15],[23,20,6,18],[24,6,7,4],[24,12,7,10,"netInfo"],[24,19,7,17],[24,22,7,20],[24,28,7,26,"NetInfo"],[24,35,7,33],[24,36,7,33,"default"],[24,43,7,33],[24,44,7,34,"fetch"],[24,49,7,39],[24,50,7,40],[24,51,7,41],[25,6,8,4],[25,10,8,8],[25,11,8,9,"netInfo"],[25,18,8,16],[25,19,8,17,"isConnected"],[25,30,8,28],[25,32,8,30],[26,8,9,6,"console"],[26,15,9,13],[26,16,9,14,"log"],[26,19,9,17],[26,20,9,18],[26,59,9,57],[26,60,9,58],[27,8,10,6],[27,15,10,13],[28,10,11,8,"success"],[28,17,11,15],[28,19,11,17],[28,24,11,22],[29,10,12,8,"message"],[29,17,12,15],[29,19,12,17],[30,8,13,6],[30,9,13,7],[31,6,14,4],[32,6,16,4],[32,10,16,8],[33,8,17,6],[34,8,18,6],[34,14,18,12],[34,18,18,16],[34,19,18,17,"syncLocations"],[34,32,18,30],[34,33,18,31],[34,34,18,32],[36,8,20,6],[37,8,21,6],[37,14,21,12],[37,18,21,16],[37,19,21,17,"syncMessages"],[37,31,21,29],[37,32,21,30],[37,33,21,31],[39,8,23,6],[40,8,24,6],[40,14,24,12],[40,18,24,16],[40,19,24,17,"syncRespondents"],[40,34,24,32],[40,35,24,33],[40,36,24,34],[41,8,26,6],[41,15,26,13],[42,10,27,8,"success"],[42,17,27,15],[42,19,27,17],[42,23,27,21],[43,10,28,8,"message"],[43,17,28,15],[43,19,28,17],[44,8,29,6],[44,9,29,7],[45,6,30,4],[45,7,30,5],[45,8,30,6],[45,15,30,13,"error"],[45,20,30,18],[45,22,30,20],[46,8,31,6,"console"],[46,15,31,13],[46,16,31,14,"error"],[46,21,31,19],[46,22,31,20],[46,35,31,33],[46,37,31,35,"error"],[46,42,31,40],[46,43,31,41],[47,8,32,6],[47,15,32,13],[48,10,33,8,"success"],[48,17,33,15],[48,19,33,17],[48,24,33,22],[49,10,34,8,"message"],[49,17,34,15],[49,19,34,17],[49,32,34,30],[50,10,35,8,"error"],[51,8,36,6],[51,9,36,7],[52,6,37,4],[53,4,38,2],[53,5,38,3],[54,4,40,2],[54,10,40,8,"syncLocations"],[54,23,40,21,"syncLocations"],[54,24,40,21],[54,26,40,24],[55,6,41,4],[55,12,41,10,"pendingLocations"],[55,28,41,26],[55,31,41,29],[55,37,41,35,"storageService"],[55,45,41,49],[55,46,41,49,"storageService"],[55,60,41,49],[55,61,41,50,"getPendingLocations"],[55,80,41,69],[55,81,41,70],[55,82,41,71],[56,6,42,4],[56,10,42,8,"pendingLocations"],[56,26,42,24],[56,27,42,25,"length"],[56,33,42,31],[56,38,42,36],[56,39,42,37],[56,41,42,39],[57,6,44,4,"console"],[57,13,44,11],[57,14,44,12,"log"],[57,17,44,15],[57,18,44,16],[57,29,44,27,"pendingLocations"],[57,45,44,43],[57,46,44,44,"length"],[57,52,44,50],[57,64,44,62],[57,65,44,63],[58,6,45,4],[58,12,45,10,"locationAPI"],[58,16,45,21],[58,17,45,21,"locationAPI"],[58,28,45,21],[58,29,45,22,"createLocationsBatch"],[58,49,45,42],[58,50,45,43,"pendingLocations"],[58,66,45,59],[58,67,45,60],[59,6,46,4],[59,12,46,10,"storageService"],[59,20,46,24],[59,21,46,24,"storageService"],[59,35,46,24],[59,36,46,25,"clearPendingLocations"],[59,57,46,46],[59,58,46,47],[59,59,46,48],[60,4,47,2],[60,5,47,3],[61,4,49,2],[61,10,49,8,"syncMessages"],[61,22,49,20,"syncMessages"],[61,23,49,20],[61,25,49,23],[62,6,50,4],[62,12,50,10,"pendingMessages"],[62,27,50,25],[62,30,50,28],[62,36,50,34,"storageService"],[62,44,50,48],[62,45,50,48,"storageService"],[62,59,50,48],[62,60,50,49,"getPendingMessages"],[62,78,50,67],[62,79,50,68],[62,80,50,69],[63,6,51,4],[63,10,51,8,"pendingMessages"],[63,25,51,23],[63,26,51,24,"length"],[63,32,51,30],[63,37,51,35],[63,38,51,36],[63,40,51,38],[64,6,53,4,"console"],[64,13,53,11],[64,14,53,12,"log"],[64,17,53,15],[64,18,53,16],[64,29,53,27,"pendingMessages"],[64,44,53,42],[64,45,53,43,"length"],[64,51,53,49],[64,62,53,60],[64,63,53,61],[65,6,54,4],[65,12,54,10,"messageAPI"],[65,16,54,20],[65,17,54,20,"messageAPI"],[65,27,54,20],[65,28,54,21,"createMessagesBatch"],[65,47,54,40],[65,48,54,41,"pendingMessages"],[65,63,54,56],[65,64,54,57],[66,6,55,4],[66,12,55,10,"storageService"],[66,20,55,24],[66,21,55,24,"storageService"],[66,35,55,24],[66,36,55,25,"clearPendingMessages"],[66,56,55,45],[66,57,55,46],[66,58,55,47],[67,4,56,2],[67,5,56,3],[68,4,58,2],[68,10,58,8,"syncRespondents"],[68,25,58,23,"syncRespondents"],[68,26,58,23],[68,28,58,26],[69,6,59,4],[69,12,59,10,"pendingRespondents"],[69,30,59,28],[69,33,59,31],[69,39,59,37,"storageService"],[69,47,59,51],[69,48,59,51,"storageService"],[69,62,59,51],[69,63,59,52,"getPendingRespondents"],[69,84,59,73],[69,85,59,74],[69,86,59,75],[70,6,60,4],[70,10,60,8,"pendingRespondents"],[70,28,60,26],[70,29,60,27,"length"],[70,35,60,33],[70,40,60,38],[70,41,60,39],[70,43,60,41],[71,6,62,4,"console"],[71,13,62,11],[71,14,62,12,"log"],[71,17,62,15],[71,18,62,16],[71,29,62,27,"pendingRespondents"],[71,47,62,45],[71,48,62,46,"length"],[71,54,62,52],[71,68,62,66],[71,69,62,67],[72,6,63,4],[72,11,63,9],[72,17,63,15,"respondent"],[72,27,63,25],[72,31,63,29,"pendingRespondents"],[72,49,63,47],[72,51,63,49],[73,8,64,6],[73,12,64,10,"respondent"],[73,22,64,20],[73,23,64,21,"id"],[73,25,64,23],[73,27,64,25],[74,10,65,8],[74,16,65,14,"respondentAPI"],[74,20,65,27],[74,21,65,27,"respondentAPI"],[74,34,65,27],[74,35,65,28,"updateRespondent"],[74,51,65,44],[74,52,65,45,"respondent"],[74,62,65,55],[74,63,65,56,"id"],[74,65,65,58],[74,67,65,60,"respondent"],[74,77,65,70],[74,78,65,71],[75,8,66,6],[76,6,67,4],[77,6,68,4],[77,12,68,10,"storageService"],[77,20,68,24],[77,21,68,24,"storageService"],[77,35,68,24],[77,36,68,25,"clearPendingRespondents"],[77,59,68,48],[77,60,68,49],[77,61,68,50],[78,4,69,2],[78,5,69,3],[79,4,71,2,"startAutoSync"],[79,17,71,15,"startAutoSync"],[79,18,71,16,"intervalMinutes"],[79,33,71,39],[79,36,71,42],[79,37,71,43],[79,39,71,45],[80,6,72,4],[80,13,72,11,"setInterval"],[80,24,72,22],[80,25,72,23],[80,31,72,29],[81,8,73,6],[81,12,73,10],[81,13,73,11,"syncAll"],[81,20,73,18],[81,21,73,19],[81,22,73,20],[82,6,74,4],[82,7,74,5],[82,9,74,7,"intervalMinutes"],[82,24,74,22],[82,27,74,25],[82,29,74,27],[82,32,74,30],[82,36,74,34],[82,37,74,35],[83,4,75,2],[84,2,76,0],[84,3,76,1],[85,0,76,2],[85,3]],"functionMap":{"names":["<global>","syncAll","syncLocations","syncMessages","syncRespondents","startAutoSync","setInterval$argument_0"],"mappings":"AAA;ECK;GDgC;EEE;GFO;EGE;GHO;EIE;GJW;EKE;uBCC;KDE;GLC"},"hasCjsExports":false},"type":"js/module"}]}